# Zebra API Overview (Work in Progress)

This API leverages JWT (JSON Web Tokens) for secure authentication, enabling operations on remote `person` records such as retrieval, creation, update, and deletion. This project is currently under development, aiming to execute specific tasks on a remote server and display the outcomes locally. At this stage, we're using "person" as a temporary placeholder to test these operations. As development progresses, we'll introduce the actual operations intended for the final version.

## Authentication

Authentication is managed through JWT. Each request to the API must include a valid JWT in the `Authorization` header.

**Generate a JWT**:
Run `TokenGenerator.php` to automatically generate and print a JWT token, used for client authentication, and save its corresponding JWT secret, used to validate the JWT token, to the `.env` file.

## Setup Instructions

### Clone the Repository Contents

To set up the API, first clone the contents of this repository into your web server's DocumentRoot.

```bash
$ git clone https://github.com/your-repo-url/pspf.git .
```

### Install Dependencies
After cloning, install the required dependencies with Composer:

```bash
$ composer install
```

### Dependencies include:
- vlucas/phpdotenv for .env file management.
- ext-pdo for database interaction.
- lcobucci/jwt for JWT authentication.

### Generate JWT
Generate a JWT and a secret key for the .env file by running:

```bash
$ php TokenGenerator.php
```
This script will output a JWT for client use and update the .env file with the secret key.

### Set up your environment

Copy the api/.env.example file to api/.env:
```bash
$ cp api/.env.example api/.env
```
Open the api/.env file in your favorite text editor. Fill in your database credentials, replacing the placeholders with your actual database details. Look for the following lines and update them accordingly:
```
DB_HOST=your_database_host
DB_PORT=your_database_port
DB_DATABASE=your_database_name
DB_USERNAME=your_database_username
DB_PASSWORD=your_database_password
```
This will configure the API to connect to your database using the credentials you've provided.
<br>*Note: This step may be removed in the final iteration.

# API Usage
Below are example curl commands to interact with the API. Replace `<Your-JWT>` with the token generated by TokenGenerator.php and `{id}` with the respective ID.

### Return All Records
```bash
$ curl -X GET http://testing.maximus-sallam.com/person \
-H "Authorization: <Your-JWT>"
```

### Return a Specific Record ID
```bash
$ curl -X GET http://testing.maximus-sallam.com/person/{id}  \
-H "Authorization: <Your-JWT>"
```

### Create a New Record

```bash
curl -X POST http://testing.maximus-sallam.com/person \
-H "Content-Type: application/json" \
-H "Authorization: <Your-JWT>" \
-d '{
      "firstname": "Jane",
      "lastname": "Fonda",
      "firstparent_id": null,
      "secondparent_id": null
    }'
```

### Update an Existing Record

```bash
$ curl -X PUT http://testing.maximus-sallam.com/person/{id} \
-H "Content-Type: application/json" \
-H "Authorization: <Your-JWT>" \
-d '{
      "firstname": "Jane",
      "lastname": "Fonda",
      "firstparent_id": null,
      "secondparent_id": null
    }'
```

### Delete an Existing Record

```bash
$ curl -X DELETE http://testing.maximus-sallam.com/person/{id} \
-H "Authorization: <Your-JWT>"
```

### Note: This API is a work in progress, intended for running functions on remote server locally. The person path will be replaced with specific functions in the final version.
